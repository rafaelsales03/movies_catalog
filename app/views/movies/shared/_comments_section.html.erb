<div class="card shadow-sm mt-4">
  <div class="card-header bg-light">
    <h3 class="mb-0 h5"><%= raw t('movies.show.comments_title') %></h3>
  </div>

  <div class="card-body">
    <%= render 'movies/shared/comment_form', movie: movie, comment: comment %>

    <% if movie.comments.any? %>
      <h5 class="mb-3 small text-muted">
         <%= t('movies.show.comments_count', count: movie.comments.count) %>
      </h5>

      <div class="list-group list-group-flush">
        <% movie.comments.order(created_at: :desc).each do |c| %>
          <div class="list-group-item px-0 py-3">
            <div class="d-flex w-100 justify-content-between align-items-start mb-1">
              <h6 class="mb-0 small">
                <i class="bi bi-person-circle me-1"></i>
                <% if c.user.present? %>
                  <strong><%= c.user.name.presence || t('activerecord.attributes.user.anonymous', default: "UsuÃ¡rio sem nome") %></strong>
                  <span class="badge bg-secondary fw-normal ms-1" style="font-size: 0.7rem;"><%= t('movies.show.commenter_registered') %></span>
                <% else %>
                  <strong><%= c.name %></strong>
                  <span class="badge bg-light text-dark border fw-normal ms-1" style="font-size: 0.7rem;"><%= t('movies.show.commenter_visitor') %></span>
                <% end %>
              </h6>
              <small class="text-muted" style="font-size: 0.8em;">
                <i class="bi bi-clock"></i> <%= t('movies.show.comment_time_ago', time: time_ago_in_words(c.created_at)) %>
              </small>
            </div>
            <p class="mb-0 small ps-3"><%= simple_format(c.content) %></p>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="text-center py-4">
        <p class="text-muted mb-0 small"><%= raw t('movies.show.no_comments_yet') %></p>
      </div>
    <% end %>
  </div>
</div>