<% comment ||= Comment.new # Initialize if not passed %>

<% if comment && comment.errors.any? %>
  <div class="alert alert-danger alert-dismissible fade show small" role="alert">
    <p class="mb-1"><strong><i class="bi bi-exclamation-triangle-fill"></i> <%= t('flash.comments.error') %></strong></p>
    <ul class="mb-0 ps-3">
      <% comment.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
    </ul>
     <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="<%= t('helpers.bootstrap.close_label', default: 'Close') %>"></button>
  </div>
<% end %>

<%= form_with model: [movie, Comment.new], local: true, class: "mb-4 border-bottom pb-4" do |f| %>
  <% if !user_signed_in? %>
    <div class="mb-3">
      <%= f.label :name, t('movies.show.comment_name_label'), class: "form-label small" %>
      <%= f.text_field :name, value: comment.name, class: "form-control form-control-sm", placeholder: t('movies.show.comment_name_placeholder'), required: true %>
    </div>
  <% else %>
     <p class="small text-muted mb-2"><%= t('movies.show.commenting_as') %> <strong><%= current_user.name %></strong></p>
  <% end %>

  <div class="mb-3">
    <%= f.label :content, t('movies.show.comment_content_label'), class: "form-label small visually-hidden" %>
    <%= f.text_area :content, value: comment.content, class: "form-control form-control-sm", rows: 3, placeholder: t('movies.show.comment_content_placeholder'), required: true %>
  </div>

  <%= f.submit t('movies.show.post_comment_button'), class: "btn btn-primary btn-sm" %>
<% end %>